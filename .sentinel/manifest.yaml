repository: github.com/Khadinxc/SentinelxTerraformDaC
branch: main
workspace: law-sentinel-dev
schemaVersion: "1.0"
content:
  microsoftRules:
  - alertRuleTemplateGuid: b3cfc7c0-092c-481c-a55b-34a3979758cb
    tactics: UNK
    description: Creates incidents for high severity alerts from Microsoft Defender for Cloud Apps
    enabled: true
    severity: UNK
    productFilter: Microsoft Cloud App Security
    alertRuleTemplateVersion: 1.0.0
    file: D:/Projects/SentinelxTerraform-DaC/content/microsoft-rules/defender-cloud-apps.yaml
    kind: MicrosoftSecurityIncidentCreation
    name: b3cfc7c0-092c-481c-a55b-34a3979758cb
    displayName: Microsoft Defender for Cloud Apps - High Severity
    techniques: UNK
  - alertRuleTemplateGuid: 90586451-8746-4b0f-aa5d-24520e93b17a
    tactics: UNK
    description: Creates incidents for alerts from Microsoft Defender for Cloud
    enabled: true
    severity: UNK
    productFilter: Azure Security Center
    alertRuleTemplateVersion: 1.0.0
    file: D:/Projects/SentinelxTerraform-DaC/content/microsoft-rules/defender-cloud.yaml
    kind: MicrosoftSecurityIncidentCreation
    name: 90586451-8746-4b0f-aa5d-24520e93b17a
    displayName: Microsoft Defender for Cloud
    techniques: UNK
  - alertRuleTemplateGuid: 532c1811-79ee-4d9f-8d4d-6304c840daa1
    tactics: UNK
    description: Creates incidents for alerts from Microsoft Defender for Endpoint
    enabled: true
    severity: UNK
    productFilter: Microsoft Defender Advanced Threat Protection
    alertRuleTemplateVersion: 1.0.0
    file: D:/Projects/SentinelxTerraform-DaC/content/microsoft-rules/defender-endpoint.yaml
    kind: MicrosoftSecurityIncidentCreation
    name: 532c1811-79ee-4d9f-8d4d-6304c840daa1
    displayName: Microsoft Defender for Endpoint
    techniques: UNK
  - alertRuleTemplateGuid: 40375cab-fbf1-4e52-9664-d94b643ba2ef
    tactics: UNK
    description: Creates incidents for alerts from Microsoft Defender for Identity
    enabled: true
    severity: UNK
    productFilter: Azure Advanced Threat Protection
    alertRuleTemplateVersion: 1.0.0
    file: D:/Projects/SentinelxTerraform-DaC/content/microsoft-rules/defender-identity.yaml
    kind: MicrosoftSecurityIncidentCreation
    name: 40375cab-fbf1-4e52-9664-d94b643ba2ef
    displayName: Microsoft Defender for Identity
    techniques: UNK
  - alertRuleTemplateGuid: fa747fb8-81d6-4965-8d3b-34e0c0b676c8
    tactics: UNK
    description: Creates incidents for alerts from Microsoft Defender for Office 365
    enabled: true
    severity: UNK
    productFilter: Office 365 Advanced Threat Protection
    alertRuleTemplateVersion: 1.0.0
    file: D:/Projects/SentinelxTerraform-DaC/content/microsoft-rules/defender-office365.yaml
    kind: MicrosoftSecurityIncidentCreation
    name: fa747fb8-81d6-4965-8d3b-34e0c0b676c8
    displayName: Microsoft Defender for Office 365
    techniques: UNK
  fusionRules:
  - description: Detects advanced multistage attacks using ML-based correlation
    alertRuleTemplateGuid: f71aba3d-28fb-450b-b192-4e76a83015c8
    tactics: UNK
    kind: Fusion
    enabled: true
    file: D:/Projects/SentinelxTerraform-DaC/content/fusion-rules/advanced-multistage-attack.yaml
    alertRuleTemplateVersion: 1.0.0
    severity: UNK
    techniques: UNK
    name: f71aba3d-28fb-450b-b192-4e76a83015c8
    displayName: Advanced Multistage Attack Detection v3
  nrtRules:
  - description: Near real-time detection of critical administrative activities that require immediate attention
    tactics:
    - PrivilegeEscalation
    - Persistence
    kind: NRT
    enabled: true
    file: D:/Projects/SentinelxTerraform-DaC/content/nrt-rules/critical-admin-activity.yaml
    severity: High
    hasQuery: true
    techniques:
    - T1078
    - T1098
    name: 48104e54-3093-4a2a-8723-01a0f4bb9eec
    displayName: Critical Admin Activity Detection
    entityMappings:
    - field_mappings:
      - column_name: Caller
        identifier: Name
      entity_type: Account
    - field_mappings:
      - column_name: CallerIpAddress
        identifier: Address
      entity_type: IP
  scheduledRules:
  - queryPeriod: PT1H
    tactics: InitialAccess
    description: This detection identifies when an external user is added to a Team or Teams chat and shares a file which is accessed by many users (>10) and the users is removed within short period of time. This might be an indicator of suspicious activity.
    enabled: true
    severity: Low
    entityMappings:
    - field_mappings:
      - column_name: MemberAdded
        identifier: FullName
      - column_name: MemberAddedAccountName
        identifier: Name
      - column_name: MemberAddedAccountUPNSuffix
        identifier: UPNSuffix
      entity_type: Account
    - field_mappings:
      - column_name: UserWhoAdded
        identifier: FullName
      - column_name: UserWhoAddedAccountName
        identifier: Name
      - column_name: UserWhoAddedAccountUPNSuffix
        identifier: UPNSuffix
      entity_type: Account
    - field_mappings:
      - column_name: UserWhoDeleted
        identifier: FullName
      - column_name: UserWhoDeletedAccountName
        identifier: Name
      - column_name: UserWhoDeletedAccountUPNSuffix
        identifier: UPNSuffix
      entity_type: Account
    - field_mappings:
      - column_name: ClientIP
        identifier: Address
      entity_type: IP
    triggerOperator: GreaterThan
    file: D:/Projects/SentinelxTerraform-DaC/content/scheduled-rules/Accessed_files_shared_by_temporary_external_user.yaml
    queryFrequency: PT1H
    suppressionDuration: PT1H
    kind: Scheduled
    name: 36b8ca8a-97ae-4576-8f44-6eb74b6b7491
    displayName: Accessed files shared by temporary external user
    suppressionEnabled: false
    techniques: T1566
    triggerThreshold: 0
  - queryPeriod: PT1H
    tactics: Exfiltration
    description: Detects unusually large data downloads that may indicate data exfiltration
    enabled: false
    severity: Medium
    entityMappings:
    - field_mappings:
      - column_name: UserId
        identifier: FullName
      entity_type: Account
    triggerOperator: GreaterThan
    file: D:/Projects/SentinelxTerraform-DaC/content/scheduled-rules/data-exfiltration-detection.yaml
    queryFrequency: PT1H
    suppressionDuration: PT1H
    kind: Scheduled
    name: 0292a9b7-8043-449a-a3af-6c52c93e10eb
    displayName: Large Data Download Detection
    suppressionEnabled: false
    techniques: T1041
    triggerThreshold: 0
  - queryPeriod: PT1H
    tactics:
    - Execution
    - DefenseEvasion
    description: Detects malware alerts from Microsoft Defender
    enabled: true
    severity: High
    entityMappings:
    - field_mappings:
      - column_name: CompromisedEntity
        identifier: HostName
      entity_type: Host
    triggerOperator: GreaterThan
    file: D:/Projects/SentinelxTerraform-DaC/content/scheduled-rules/malware-detection.yaml
    queryFrequency: PT1H
    suppressionDuration: PT1H
    kind: Scheduled
    name: d466daf3-76a2-47eb-a48b-94aefb7035ec
    displayName: Malware Detection from Defender
    suppressionEnabled: false
    techniques:
    - T1059
    - T1027
    triggerThreshold: 0
  - queryPeriod: PT1H
    tactics:
    - PrivilegeEscalation
    - Persistence
    description: Detects potential privilege escalation activities in Azure AD
    enabled: true
    severity: High
    entityMappings:
    - field_mappings:
      - column_name: InitiatedBy
        identifier: FullName
      entity_type: Account
    - field_mappings:
      - column_name: TargetUser
        identifier: FullName
      entity_type: Account
    triggerOperator: GreaterThan
    file: D:/Projects/SentinelxTerraform-DaC/content/scheduled-rules/privilege-escalation-detection.yaml
    queryFrequency: PT1H
    suppressionDuration: PT1H
    kind: Scheduled
    name: 577707bf-d967-4a33-8345-69d43a3d9287
    displayName: Privilege Escalation Detection
    suppressionEnabled: false
    techniques:
    - T1078
    - T1098
    triggerThreshold: 0
  - queryPeriod: PT1H
    tactics:
    - CredentialAccess
    - InitialAccess
    description: Detects suspicious login activities based on failed login attempts and unusual locations
    enabled: true
    severity: High
    entityMappings:
    - field_mappings:
      - column_name: UserPrincipalName
        identifier: FullName
      entity_type: Account
    - field_mappings:
      - column_name: IPAddress
        identifier: Address
      entity_type: IP
    triggerOperator: GreaterThan
    file: D:/Projects/SentinelxTerraform-DaC/content/scheduled-rules/suspicious-login-activity.yaml
    queryFrequency: PT1H
    suppressionDuration: PT1H
    kind: Scheduled
    name: ebe00948-92a9-4bd4-bb4a-904be886c86c
    displayName: Suspicious Login Activity Detection
    suppressionEnabled: false
    techniques:
    - T1110
    - T1078
    triggerThreshold: 0

