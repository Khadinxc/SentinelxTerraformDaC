display_name: "Malware Detection from Defender"
description: "Detects malware alerts from Microsoft Defender"
severity: "High"
enabled: true
query: |
  SecurityAlert
  | where TimeGenerated > ago(1h)
  | where AlertName contains "malware" or AlertName contains "virus"
  | where AlertSeverity in ("High", "Medium")
  | project TimeGenerated, AlertName, AlertSeverity, CompromisedEntity, Description
query_frequency: "PT1H"
query_period: "PT1H"
trigger_operator: "GreaterThan"
trigger_threshold: 0
suppression_enabled: false
suppression_duration: "PT1H"
tactics:
  - "Execution"
  - "DefenseEvasion"
techniques:
  - "T1059"
  - "T1027"
entity_mappings:
  - entity_type: "Host"
    field_mappings:
      - identifier: "HostName"
        column_name: "CompromisedEntity"
incident_configuration:
  create_incident: true
  grouping_enabled: false
custom_details: {}
event_grouping:
  aggregation_method: "SingleAlert"
